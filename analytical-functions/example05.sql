--------------------------------------------------------------------------------
--Example #05: Create percent of weight off total weight within gender
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--1st way (better)
--------------------------------------------------------------------------------
select c.*
     , round((100 * ratio_to_report(c.weight) over (partition by c.gender)), 2) pct_wt_gender
  from childstat c
;

--------------------------------------------------------------------------------
--2nd way
--------------------------------------------------------------------------------
select c.*
     , round(100 * (c.weight / sum(c.weight) over (partition by c.gender)), 2) pct_wt_gender
  from childstat c
;
